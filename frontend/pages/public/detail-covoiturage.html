<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>Détails du trajet – EcoRide</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../../assets/styles/main.min.css" />
    <script src="https://kit.fontawesome.com/6cca64e339.js" crossorigin="anonymous"></script>
  </head>

  <body class="detail-page">
    <div class="desktop-view">
      <!-- Header -->
      <header class="header">
        <div class="header__logo">
          <button aria-label="Retour" onclick="window.history.back()">
            <i class="fa-solid fa-arrow-left"></i>
          </button>
          <span>Détails du trajet</span>
        </div>
        <button class="header__menu" aria-label="Partager">
          <i class="fa-solid fa-share-nodes"></i>
        </button>
      </header>

      <main class="detail-main">
        <!-- Icône carte / hero (affiché uniquement sur mobile) -->
        <section class="trip-hero">
          <div class="icon-map">
            <i class="fa-solid fa-map"></i>
          </div>
        </section>

        <!-- Contenu principal (colonne gauche sur desktop) -->
        <div class="trip-content">
          <!-- Section conducteur (première sur desktop) -->
          <section class="driver-section">
            <div class="driver-header">
              <img
                id="driver-avatar"
                src="../../assets/images/avatar-placeholder.jpg"
                alt="Photo du conducteur"
              />
              <div class="info">
                <div class="name" id="driver-name">Chargement...</div>
                <div class="meta">
                  <i class="fa-solid fa-star"></i>
                  <span id="driver-rating">0.0</span>
                  <span>•</span>
                  <span id="driver-trips">0 trajets</span>
                </div>
              </div>
              <i class="verified fa-solid fa-circle-check" id="verified-badge"></i>
            </div>
            <div class="driver-stats">
              <span>
                <span>Taux de réponse</span>
                <span id="response-rate">--</span>
              </span>
              <span>
                <span>Délai de réponse</span>
                <span id="response-time">--</span>
              </span>
            </div>
            <button class="contact-btn" aria-label="Contacter le conducteur" id="contact-btn">
              Contacter le conducteur
            </button>
          </section>

          <!-- Détails du trajet -->
          <section class="trip-details">
            <div class="trip-details__header">
              <div class="infos">
                <div class="date" id="trip-date">Chargement...</div>
                <div class="route" id="trip-route">Chargement...</div>
              </div>
              <div class="price">
                <div class="amount" id="trip-price">--€</div>
                <div class="unit">par personne</div>
              </div>
            </div>

            <div class="stats">
              <div class="stat-item">
                <i class="fa-regular fa-clock"></i>
                <div class="detail">
                  <div class="main" id="trip-times">Chargement...</div>
                  <div class="sub" id="trip-duration">-- de trajet</div>
                </div>
              </div>

              <div class="stat-item">
                <i class="fa-solid fa-user-group"></i>
                <div class="detail">
                  <div class="main" id="seats-available">-- places disponibles</div>
                </div>
              </div>

              <div class="stat-item">
                <i class="fa-solid fa-leaf"></i>
                <div class="detail">
                  <div class="main" id="co2-info">-- CO₂/km</div>
                  <div class="sub" id="environmental-impact">Impact environnemental --</div>
                </div>
              </div>
            </div>

            <!-- Véhicule (partie des détails du trajet) -->
            <div class="vehicle-section">
              <h3>Véhicule</h3>
              <div class="vehicle-info">
                <div class="icon-wrapper">
                  <i class="fa-solid fa-car"></i>
                </div>
                <div class="details">
                  <div class="model" id="vehicle-model">Chargement...</div>
                  <div class="specs" id="vehicle-specs">-- • --</div>
                  <div class="tags" id="vehicle-tags">
                    <span>Chargement...</span>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <!-- Section Avis -->
          <section class="reviews-section">
            <div class="reviews-section__header">
              <h3>Avis</h3>
              <div class="rating">
                <i class="fa-solid fa-star"></i>
                <span id="reviews-rating">--</span>
                <span id="reviews-count">(--)</span>
              </div>
            </div>
            <div class="reviews-list" id="reviews-list">
              <!-- Les avis seront injectés ici dynamiquement -->
            </div>
            <button class="view-all" aria-label="Voir tous les avis sur le conducteur">
              Voir tous les avis
            </button>
          </section>
        </div>

        <!-- Barre latérale (affiché uniquement sur desktop) -->
        <div class="trip-sidebar">
          <!-- Préférences -->
          <section class="preferences-section">
            <h3>Préférences</h3>
            <div class="prefs-list" id="prefs-list">
              <!-- Les préférences seront injectées ici dynamiquement -->
            </div>

            <!-- Réservation (version desktop) -->
            <div class="booking-desktop">
              <div class="info">
                <div class="price">
                  <div class="label">Prix total</div>
                  <div class="amount" id="total-price">--€</div>
                </div>
                <button class="btn-book" aria-label="Réserver ce trajet">Réserver</button>
              </div>
              <div class="cancel-info">Annulation gratuite jusqu'à 24h avant le départ</div>
            </div>
          </section>

          <!-- Logo EcoRide (visible uniquement en desktop) -->
          <div class="logo-desktop">
            <img src="../../assets/images/Logo_EcoRide.svg" alt="EcoRide" />
          </div>
        </div>
      </main>
    </div>
    <div class="mobile-view">
      <div class="mobile-root">
        <header class="mobile-header">
          <div class="mobile-header__content">
            <div class="mobile-header__wrapper">
              <button
                class="mobile-header__back-btn"
                aria-label="Retour"
                onclick="window.history.back()"
              >
                <i class="fa-solid fa-arrow-left"></i>
              </button>
              <h1 class="mobile-header__title">Détails du trajet</h1>
              <button class="mobile-header__share-btn" aria-label="Partager">
                <i class="fa-solid fa-share-nodes"></i>
              </button>
            </div>
          </div>
        </header>
        <main class="mobile-main">
          <div class="mobile-hero">
            <div class="mobile-hero__icon">
              <img src="../../assets/images/Logo_EcoRide.svg" alt="EcoRide" />
            </div>
          </div>
          <section class="mobile-detail">
            <div class="mobile-detail__header">
              <div class="mobile-detail__date-route">
                <div class="mobile-detail__date" id="mobile-trip-date">Chargement...</div>
                <div class="mobile-detail__route" id="mobile-trip-route">Chargement...</div>
              </div>
              <div class="mobile-detail__price-wrapper">
                <div class="mobile-detail__price" id="mobile-price">--€</div>
                <div class="mobile-detail__price-unit">par personne</div>
              </div>
            </div>
            <div class="mobile-stats">
              <div class="mobile-stats__item">
                <div class="mobile-stats__icon">
                  <i class="fa-regular fa-clock"></i>
                </div>
                <div class="mobile-stats__content">
                  <div class="mobile-stats__main" id="mobile-trip-times">Chargement...</div>
                  <div class="mobile-stats__sub" id="mobile-trip-duration">-- de trajet</div>
                </div>
              </div>
              <div class="mobile-stats__item">
                <div class="mobile-stats__icon">
                  <i class="fa-solid fa-user-group"></i>
                </div>
                <div class="mobile-stats__content">
                  <div class="mobile-stats__main" id="mobile-seats-available">-- places disponibles</div>
                </div>
              </div>
              <div class="mobile-stats__item">
                <div class="mobile-stats__icon">
                  <i class="fa-solid fa-leaf"></i>
                </div>
                <div class="mobile-stats__content">
                  <div class="mobile-stats__main" id="mobile-co2-info">-- CO₂/km</div>
                  <div class="mobile-stats__sub" id="mobile-environmental-impact">Impact environnemental --</div>
                </div>
              </div>
            </div>
            <div class="mobile-driver">
              <div class="mobile-driver__header">
                <img
                  id="mobile-driver-avatar"
                  src="../../assets/images/avatar-placeholder.jpg"
                  class="mobile-driver__avatar"
                  alt="Photo du conducteur"
                />
                <div class="mobile-driver__info">
                  <div class="mobile-driver__name" id="mobile-driver-name">Chargement...</div>
                  <div class="mobile-driver__meta">
                    <i class="fa-solid fa-star"></i>
                    <span id="mobile-driver-rating">--</span>
                    <span>•</span>
                    <span id="mobile-driver-trips">-- trajets</span>
                  </div>
                </div>
                <i class="fa-solid fa-circle-check mobile-driver__verified" id="mobile-verified-badge"></i>
              </div>
              <div class="mobile-driver__stats">
                <div class="mobile-driver__stat">
                  <span class="mobile-driver__stat-label">Taux de réponse</span>
                  <span class="mobile-driver__stat-value" id="mobile-response-rate">--</span>
                </div>
                <div class="mobile-driver__stat">
                  <span class="mobile-driver__stat-label">Délai de réponse</span>
                  <span class="mobile-driver__stat-value" id="mobile-response-time">--</span>
                </div>
              </div>
              <button class="mobile-driver__contact-btn" aria-label="Contacter le conducteur" id="mobile-contact-btn">
                Contacter le conducteur
              </button>
            </div>
            <div class="mobile-vehicle">
              <h3 class="mobile-vehicle__title">Véhicule</h3>
              <div class="mobile-vehicle__info">
                <div class="mobile-vehicle__icon">
                  <i class="fa-solid fa-car"></i>
                </div>
                <div class="mobile-vehicle__details">
                  <div class="mobile-vehicle__model" id="mobile-vehicle-model">Chargement...</div>
                  <div class="mobile-vehicle__specs" id="mobile-vehicle-specs">-- • --</div>
                  <div class="mobile-vehicle__tags" id="mobile-vehicle-tags">
                    <span class="mobile-vehicle__tag">Chargement...</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="mobile-prefs">
              <h3 class="mobile-prefs__title">Préférences</h3>
              <div class="mobile-prefs__grid" id="mobile-prefs-list">
                <!-- Les préférences seront injectées ici dynamiquement -->
              </div>
            </div>
            <div class="mobile-reviews">
              <div class="mobile-reviews__header">
                <h3 class="mobile-reviews__title">Avis</h3>
                <div class="mobile-reviews__rating">
                  <i class="fa-solid fa-star"></i>
                  <span id="mobile-reviews-rating">--</span>
                  <span id="mobile-reviews-count">(--)</span>
                </div>
              </div>
              <div class="mobile-reviews__list" id="mobile-reviews-list">
                <!-- Les avis seront injectés ici dynamiquement -->
              </div>
              <button
                class="mobile-reviews__view-all"
                aria-label="Voir tous les avis sur le conducteur"
              >
                Voir tous les avis
              </button>
            </div>
          </section>
        </main>
        <div class="mobile-booking-footer">
          <div class="mobile-booking-footer__content">
            <div class="mobile-booking-footer__price-info">
              <div class="mobile-booking-footer__price-label">Prix total</div>
              <div class="mobile-booking-footer__price" id="mobile-total-price">--€</div>
            </div>
            <button class="mobile-booking-footer__btn" aria-label="Réserver ce trajet">
              Réserver
            </button>
          </div>
          <p class="mobile-booking-footer__note">Annulation gratuite jusqu'à 24h avant le départ</p>
        </div>
      </div>
    </div>
    <!-- Modal de confirmation de réservation -->
    <div class="modal" id="reservation-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Confirmer la réservation</h2>
          <button class="close-modal" aria-label="Fermer">&times;</button>
        </div>
        <div class="modal-body">
          <p>Trajet : <span id="modal-ride-route"></span> le <span id="modal-ride-date"></span></p>
          <p>Coût : <span id="modal-price"></span> crédits</p>
          <p>Solde actuel : <span id="modal-current-balance"></span> crédits</p>
          <p>Solde après réservation : <span id="modal-new-balance"></span> crédits</p>
        </div>
        <div class="form-buttons">
          <button class="btn-secondary close-modal">Annuler</button>
          <button class="btn-primary" id="confirm-reservation-btn">Confirmer ma réservation</button>
        </div>
      </div>
    </div>
    <!-- Scripts -->
    <script type="module" src="../../assets/js/common/api.js"></script>
    <script type="module" src="../../assets/js/common/auth.js"></script>
    <script type="module" src="../../assets/js/pages/detail-covoiturage.js"></script>
  </body>
</html>
